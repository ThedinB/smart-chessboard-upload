<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Firmware – Tadeášova Chytrá Šachovnice</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-color: #333;
      --secondary-color: #555;
      --accent-color: #4CAF50;
      --background-color: #f4f4f4;
      --container-background: #ffffff;
      --text-color: #333;
      --light-text-color: #ffffff;
      --error-color: #D8000C;
      --success-color: #270;
      --info-color: #00529B;
      --border-radius: 5px;
      --box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    body {
      font-family: 'Roboto', Arial, sans-serif;
      line-height: 1.6;
      margin: 0;
      padding: 0;
      background-color: var(--background-color);
      color: var(--text-color);
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
      box-sizing: border-box;
    }

    .container {
      background-color: var(--container-background);
      padding: 30px 40px;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      text-align: center;
      max-width: 800px; /* Trochu širší pro delší návod */
      width: 100%;
      margin-top: 30px;
      margin-bottom: 30px;
    }

    header h1 {
      color: var(--primary-color);
      margin-bottom: 0.5em;
      font-size: 2.2em;
      border-bottom: 2px solid var(--accent-color);
      padding-bottom: 0.5em;
      display: inline-block;
    }

    .intro-text, .instructions-section h2, .instructions-title, .instructions ol li, .instructions ul li, .download-section p {
      color: var(--text-color);
      font-size: 1.1em;
      margin-bottom: 1em;
    }

    .instructions-section h2 {
        font-size: 1.8em;
        margin-top: 30px;
        margin-bottom: 15px;
    }
    
    .instructions {
      text-align: left;
      background-color: #e9e9e9;
      padding: 20px;
      border-radius: var(--border-radius);
      margin: 20px auto;
      border-left: 5px solid var(--accent-color);
    }

    .instructions-title {
      font-weight: bold;
      font-size: 1.2em;
      margin-top: 1.5em;
      margin-bottom: 0.8em;
      color: var(--primary-color);
    }
    .instructions-title:first-child {
        margin-top: 0;
    }


    .instructions ol, .instructions ul {
      padding-left: 25px; /* Odsazení seznamů */
      margin: 0 0 1em 0;
    }

    .instructions ol li, .instructions ul li {
      margin-bottom: 0.6em;
    }
    .instructions ol li::marker {
        font-weight: bold;
        color: var(--accent-color);
    }
    .instructions ul {
        list-style-type: disc; /* Typ odrážek pro ul */
    }
    .instructions ul ul { /* Vnořený seznam */
        list-style-type: circle;
        margin-top: 0.5em;
    }


    .download-section {
        margin-top: 20px;
        margin-bottom: 30px;
    }
    .download-section h2 {
        font-size: 1.8em;
        margin-bottom: 15px;
    }

    .download-button {
      display: inline-block;
      padding: 12px 25px;
      background: linear-gradient(135deg, var(--accent-color) 0%, #3e8e41 100%);
      color: var(--light-text-color);
      border: none;
      cursor: pointer;
      font-size: 1.1em;
      font-weight: bold;
      border-radius: var(--border-radius);
      transition: all 0.3s ease;
      box-shadow: 0 2px 5px rgba(0,0,0,0.15);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-top: 10px; /* Menší margin nad tlačítkem */
      text-decoration: none;
    }

    .download-button:hover, .download-button:focus {
      background: linear-gradient(135deg, #3e8e41 0%, var(--accent-color) 100%);
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transform: translateY(-2px);
      color: var(--light-text-color);
    }
    .download-button:active {
        transform: translateY(0);
        box-shadow: 0 2px 5px rgba(0,0,0,0.15);
    }

    pre { /* Styl pro bloky s kódem */
        background-color: #333; /* Tmavší pozadí pro kód */
        color: #f0f0f0; /* Světlejší text kódu */
        padding: 15px;
        border-radius: var(--border-radius);
        overflow-x: auto;
        font-size: 0.9em;
        border: 1px solid #444;
    }
    code { /* Styl pro inline kód */
        background-color: #e0e0e0;
        padding: 0.2em 0.4em;
        border-radius: 3px;
        font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    }


    footer {
      margin-top: auto; /* Odsune patičku dolů, pokud je málo obsahu */
      padding: 20px;
      color: #777;
      font-size: 0.9em;
      text-align: center; /* Centrování textu v patičce */
      width:100%;
    }
    footer a {
        color: var(--accent-color);
        text-decoration: none;
    }
    footer a:hover {
        text-decoration: underline;
    }

    .icon {
        vertical-align: middle;
        margin-right: 8px; /* Větší mezera vedle ikony */
        height: 1.2em; 
    }

    @media (max-width: 768px) { /* Úpravy pro menší obrazovky */
      .container {
        padding: 20px;
        margin-top: 10px;
      }
      header h1 {
        font-size: 1.8em;
      }
      .intro-text, .instructions-section h2, .instructions ol li, .instructions ul li, .download-section p {
        font-size: 1em;
      }
      .download-section h2, .instructions-section h2 {
        font-size: 1.5em;
      }
      pre {
        font-size: 0.85em;
      }
    }
  </style>
</head>
<body>

  <div class="container">
    <header>
      <h1>Firmware pro Chytrou Šachovnici</h1>
    </header>

    <section class="intro-section">
      <p class="intro-text">
        Vítej! Děkuji ti za podporu mého projektu chytré šachovnice. Na této stránce si můžeš stáhnout nejnovější verzi firmwaru a najdeš zde návod, jak jej nahrát do svého Arduina Mega.
      </p>
    </section>

    <section class="download-section">
      <h2>Stažení Firmwaru</h2>
      <p>Kliknutím na tlačítko níže si stáhni soubor <code>SmartChessboardFirmware_v1.bin</code>.</p>
      <a href="SmartChessboardFirmware_v1.bin" class="download-button" download>
        <svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24"><path d="M0 0h24v24H0z" fill="none"/><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM17 13l-5 5-5-5h3V9h4v4h3z"/></svg>
        Stáhnout Firmware
      </a>
      <p style="font-size: 0.9em; margin-top: 15px;"><em>Po stažení souboru pokračuj podle níže uvedeného návodu.</em></p>
    </section>

    <section class="instructions-section">
      <h2>Návod k nahrání firmwaru (pomocí AVRDUDE)</h2>
      <div class="instructions">
        <p class="instructions-title">Co budeš potřebovat:</p>
        <ul>
          <li>Nainstalované <strong>Arduino IDE</strong> (pokud nemáš, stáhni z <a href="https://www.arduino.cc/en/software" target="_blank" rel="noopener noreferrer">oficiálních stránek arduino.cc</a>).</li>
          <li>Stažený soubor firmwaru <code>SmartChessboardFirmware_v1.bin</code> (z odkazu výše).</li>
          <li>Tvé Arduino Mega připojené k počítači přes USB kabel.</li>
        </ul>

        <p class="instructions-title">Krok 1: Zjištění COM portu tvého Arduina Mega</p>
        <ol>
          <li>Otevři <strong>Správce zařízení</strong> ve Windows. (Nejrychleji: klikni pravým tlačítkem na tlačítko Start a vyber "Správce zařízení").</li>
          <li>V okně Správce zařízení rozbal sekci nadepsanou "Porty (COM a LPT)".</li>
          <li>Najdi položku, která odpovídá tvému Arduinu Mega. Může se jmenovat například "Arduino Mega 2560 (COM<strong>X</strong>)" nebo "USB Serial Port (COM<strong>X</strong>)". Důležité je číslo portu **X** (např. COM3, COM8, atd.). **Toto číslo si poznamenej.**</li>
        </ol>

        <p class="instructions-title">Krok 2: Příprava souborů a Příkazového řádku</p>
        <ol>
          <li>Pro zjednodušení si na disku vytvoř novou složku, například <code>C:\SachyFirmware\</code>.</li>
          <li>Do této nově vytvořené složky (<code>C:\SachyFirmware\</code>) zkopíruj následující tři soubory:
            <ul>
              <li>Stažený firmware: <code>SmartChessboardFirmware_v1.bin</code>.</li>
              <li>Program <code>avrdude.exe</code>. Najdeš ho v instalační složce Arduino IDE, typicky v:
                <br><code>C:\Program Files (x86)\Arduino\hardware\tools\avr\bin\avrdude.exe</code></li>
              <li>Konfigurační soubor <code>avrdude.conf</code>. Najdeš ho také v instalaci Arduino IDE, typicky v:
                <br><code>C:\Program Files (x86)\Arduino\hardware\tools\avr\etc\avrdude.conf</code></li>
            </ul>
          </li>
          <li>Otevři <strong>Příkazový řádek</strong>. (Do vyhledávacího pole Windows napiš <code>cmd</code> a spusť aplikaci "Příkazový řádek").</li>
          <li>V okně Příkazového řádku přejdi do složky, kterou sis vytvořil v bodě 1 (např. <code>C:\SachyFirmware\</code>). Zadej příkaz:
            <br><code>cd C:\SachyFirmware\</code>
            <br>(Pokud jsi složku vytvořil jinde nebo ji jinak pojmenoval, nahraď cestu správně). Stiskni Enter. Prompt by se měl změnit a ukazovat tuto složku.
          </li>
        </ol>
        
        <p class="instructions-title">Krok 3: Spuštění příkazu pro nahrání firmwaru</p>
        <ol>
          <li>Ujisti se, že tvé Arduino Mega je stále připojené k počítači přes USB.</li>
          <li>Zkopíruj celý následující příkaz. Ve svém textovém editoru (nebo přímo v příkazovém řádku) **nahraď <code>COMX</code> skutečným číslem COM portu**, které jsi zjistil v Kroku 1.
            <pre><code>avrdude -C avrdude.conf -v -p atmega2560 -c wiring -P COMX -b 115200 -D -U flash:w:SmartChessboardFirmware_v1.bin:r</code></pre>
          </li>
          <li>Vlož upravený příkaz do Příkazového řádku.</li>
          <li><strong>VELMI DŮLEŽITÝ KROK:</strong> Připrav se! Ihned po stisknutí klávesy <strong>Enter</strong> pro spuštění příkazu (nebo těsně před jeho stisknutím) **krátce stiskni resetovací tlačítko** na tvém Arduinu Mega. Správné načasování resetu je klíčové pro to, aby se spustil bootloader a `avrdude` se s ním mohl spojit.</li>
          <li>Sleduj výstup v Příkazovém řádku. Pokud se vše podařilo, uvidíš text informující o procesu nahrávání (reading, writing, verifying) a na konci by se měla objevit zpráva jako <code>avrdude done. Thank you.</code></li>
        </ol>

        <p class="instructions-title">Co dělat při problémech?</p>
        <ul>
          <li><strong><code>'avrdude' is not recognized...</code></strong>: Nejsi ve složce, kde je <code>avrdude.exe</code>, nebo jsi příkaz nenapsal přesně. Zkus použít <code>.\avrdude</code> (pokud jsi ve složce s ním).</li>
          <li><strong><code>can't open config file "avrdude.conf"</code></strong>: Program <code>avrdude.exe</code> nemůže najít soubor <code>avrdude.conf</code>. Ujisti se, že oba soubory jsou ve stejné složce, ze které spouštíš příkaz, a že v příkazu je <code>-C avrdude.conf</code>.</li>
          <li><strong><code>programmer is not responding</code></strong> nebo <strong><code>stk500v2_ReceiveMessage(): timeout</code></strong>:
            <ul>
                <li>Znovu zkontroluj, zda máš v příkazu správné číslo <strong>COM portu</strong>.</li>
                <li>Ujisti se, že <strong>Arduino IDE nebo jiný program, který by mohl používat sériový port, je zavřený</strong>.</li>
                <li>Zkus <strong>jinak načasovat stisk resetovacího tlačítka</strong> (trochu dříve, trochu později).</li>
                <li>Zkus v příkazu změnit baud rate <code>-b 115200</code> na <code>-b 57600</code>.</li>
                <li>Zkus v příkazu změnit typ programátoru <code>-c wiring</code> na <code>-c stk500v2</code>.</li>
            </ul>
          </li>
        </ul>
        <p>Pokud problémy přetrvávají, neváhej mě kontaktovat na <a href="mailto:tadeas.chess@gmail.com">tadeas.chess@gmail.com</a> s popisem problému a výpisem z příkazového řádku.</p>
      </div>
    </section>
    <section class="command-generator-section">
      <h2>Generátor příkazu pro nahrání (AVRDUDE)</h2>
      <p>Pro zjednodušení si zde můžete nechat vygenerovat přesný příkaz pro nahrání firmwaru. Stačí zadat COM port vašeho Arduina Mega.</p>
      
      <div style="margin-bottom: 15px;">
        <label for="comPortInput" style="font-weight: bold; margin-right: 10px;">Zadejte váš COM port (např. COM5):</label>
        <input type="text" id="comPortInput" placeholder="COMX" style="padding: 8px; border-radius: 4px; border: 1px solid #ccc; width: 100px;">
      </div>
      
      <button onclick="generateAvrdudeCommand()" class="download-button" style="background: var(--secondary-color); margin-bottom:15px;">Vygenerovat příkaz</button>
      
      <p style="font-weight: bold;">Váš příkaz k nahrání (zkopírujte jej celý):</p>
      <pre style="background-color: #333; color: #f0f0f0; padding: 15px; border-radius: 5px; overflow-x: auto; font-size: 0.9em; border: 1px solid #444; text-align: left; min-height: 50px;"
      ><code id="avrdudeCommandOutput" style="background-color:transparent; color: #f0f0f0; padding:0;">Sem zadejte COM port a klikněte na tlačítko "Vygenerovat příkaz"...</code></pre>
    </section>
    

  </div>

  <footer>
    <p>© <span id="currentYear"></span> Tadeášova Chytrá Šachovnice. Pro podporu piš na <a href="mailto:tadeas.chess@gmail.com">tadeas.chess@gmail.com</a>.</p>
  </footer>

  <script>
    function generateAvrdudeCommand() {
        const comPort = document.getElementById('comPortInput').value.trim().toUpperCase();
        const firmwareFile = 'SmartChessboardFirmware_v1.bin';
        const commandOutputElement = document.getElementById('avrdudeCommandOutput');

        if (!comPort) {
            commandOutputElement.textContent = 'Prosím, zadejte platný COM port (např. COM5).';
            return;
        }
        
        if (!comPort.startsWith('COM') || isNaN(parseInt(comPort.substring(3)))) {
             commandOutputElement.textContent = 'Nesprávný formát COM portu. Zadejte např. COM5.';
             return;
        }

        const command = `avrdude -C avrdude.conf -v -p atmega2560 -c wiring -P ${comPort} -b 115200 -D -U flash:w:${firmwareFile}:r`;
        commandOutputElement.textContent = command;
    }

    // Skript pro vložení aktuálního roku do patičky
    document.getElementById('currentYear').textContent = new Date().getFullYear();
  </script>

  

</body>
</html>
